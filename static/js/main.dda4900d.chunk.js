(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(t,e,n){t.exports=n(30)},18:function(t,e,n){},22:function(t,e,n){},24:function(t,e,n){},26:function(t,e,n){},28:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),s=n(9),c=n.n(s),o=(n(18),n(1)),r=n(2),u=n(4),m=n(3),p=n(5),h=n(7),l=n(10),y=new(n(11).Dispatcher),f=new(function(t){function e(){var t;return Object(o.a)(this,e),(t=Object(u.a)(this,Object(m.a)(e).call(this))).fetchData(),t.current={country:"",city:"",company:"",location:""},t}return Object(p.a)(e,t),Object(r.a)(e,[{key:"constructData",value:function(t){var e=this;this.items=new Map,this.locations=new Map;for(var n=0;n<t.length;n++){if(this.items.has(t[n].Country))if(this.items.get(t[n].Country).has(t[n].City)){var i=this.items.get(t[n].Country).get(t[n].City);i.push(t[n].CompanyName),this.items.get(t[n].Country).set(t[n].City,i)}else this.items.get(t[n].Country).set(t[n].City,[t[n].CompanyName]);else{var a=(new Map).set(t[n].City,[t[n].CompanyName]);this.items.set(t[n].Country,a)}this.locations.set(t[n].CompanyName,{id:t[n].Id,country:t[n].Country,city:t[n].City,address:t[n].Address,postal:t[n].PostalCode})}this.items=new Map(Object(h.a)(this.items).sort(function(t,e){return e[1].size-t[1].size})),this.items.forEach(function(t,n,i){t.forEach(function(t){t.sort(function(t,e){return e-t})});var a=new Map(Object(h.a)(t.entries()).sort(function(t,e){return e[1].length-t[1].length}));e.items.set(n,a)}),this.current.country=this.items.keys().next().value,this.setInitCityState(),this.setInitCompanyState()}},{key:"setInitCityState",value:function(){this.current.city=this.items.get(this.current.country).keys().next().value}},{key:"setInitCompanyState",value:function(){this.current.company=this.items.get(this.current.country).get(this.current.city)[0],this.current.location=this.locations.get(this.current.company)}},{key:"getCountries",value:function(){return Object(h.a)(this.items.keys())}},{key:"getCities",value:function(){return Object(h.a)(this.items.get(this.current.country).keys())}},{key:"getCompanies",value:function(){return this.items.get(this.current.country).get(this.current.city)}},{key:"getLocation",value:function(){return this.locations.get(this.current.company)}},{key:"fetchData",value:function(){var t=this,e=new Request("/clients.json",{method:"GET",headers:new Headers({"Content-type":"application/json"})});fetch(e).then(function(t){return t.json()}).then(function(e){t.constructData(e.Customers),t.emit("init")}).catch(function(t){return console.log(t)})}},{key:"handleActions",value:function(t){switch(t.type){case"GET_CITIES":this.current.country=t.data,this.setInitCityState(),this.setInitCompanyState(),this.emit("get_cities"),this.emit("get_companies"),this.emit("get_company_loc");break;case"GET_COMPANIES":this.current.city=t.data,this.setInitCompanyState(),this.emit("get_companies"),this.emit("get_company_loc");break;case"GET_COMPANY_LOC":this.current.company=t.data,this.emit("get_company_loc")}}}]),e}(l.EventEmitter));y.register(f.handleActions.bind(f));var d=f,g=n(6);n(22);var C=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(m.a)(e).call(this,t))).getItemsOf=n.getItemsOf.bind(Object(g.a)(Object(g.a)(n))),n}return Object(p.a)(e,t),Object(r.a)(e,[{key:"getItemsOf",value:function(t,e){switch(t){case"country":a=e,y.dispatch({type:"GET_CITIES",data:a});break;case"city":i=e,y.dispatch({type:"GET_COMPANIES",data:i});break;case"company":n=e,y.dispatch({type:"GET_COMPANY_LOC",data:n});break;default:console.log("NO SUCH TYPE")}var n,i,a}},{key:"render",value:function(){var t=this,e=this.props.name===d.current[this.props.type]?"item selected":"item";return a.a.createElement("li",{className:e,onClick:function(){t.props.name!==d.current[t.props.type]&&t.getItemsOf(t.props.type,t.props.name)}},this.props.name)}}]),e}(i.Component),v=(n(24),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(r.a)(e,[{key:"render",value:function(){var t=this,e=this.props.items.map(function(e){return a.a.createElement(C,{className:"item",key:e,type:t.props.type,name:e})});return a.a.createElement("div",{className:"container"},a.a.createElement("h3",{className:"title"},this.props.title),a.a.createElement("ul",{className:"list"},e))}}]),e}(i.Component));n(26);var O=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(m.a)(e).call(this,t))).geoCodeUrl="https://maps.googleapis.com/maps/api/geocode/json",n.mapsUrl="https://maps.googleapis.com/maps/api/js",n.apiKey="AIzaSyCMx4iDaFk3yaGp6YZhrQK1bn-aYi_5SLg",n}return Object(p.a)(e,t),Object(r.a)(e,[{key:"getLocation",value:function(){var t=this,e=this.props.location,n="".concat(this.geoCodeUrl,"?key=").concat(this.apiKey,"&address=").concat(e.address,",").concat(e.city,",").concat(e.country,",").concat(e.postal);fetch(n).then(function(t){return t.json()}).then(function(e){e.results.length>0&&t.initMap(e.results[0].geometry.location)}).catch(function(t){return console.log(t)})}},{key:"initMap",value:function(t){var e=new window.google.maps.Map(window.document.getElementById("map"),{center:t,zoom:12});new window.google.maps.Marker({position:t,map:e})}},{key:"loadMap",value:function(){window.initMap=this.initMap,function(t){var e=window.document.getElementById("root"),n=window.document.createElement("script");n.src=t,n.async=!0,n.defer=!0,e.after(n)}("".concat(this.mapsUrl,"?key=").concat(this.apiKey))}},{key:"componentDidMount",value:function(){this.loadMap()}},{key:"componentDidUpdate",value:function(){this.getLocation()}},{key:"render",value:function(){return a.a.createElement("div",{className:"map_container"},a.a.createElement("h3",{className:"title"},"Map"),a.a.createElement("div",{id:"map"}))}}]),e}(i.Component),b=(n(28),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(m.a)(e).call(this,t))).state={countries:[],cities:[],companies:[],location:{}},n}return Object(p.a)(e,t),Object(r.a)(e,[{key:"componentDidMount",value:function(){var t=this;d.on("init",function(){t.setState({countries:d.getCountries(),cities:d.getCities(),companies:d.getCompanies(),location:d.getLocation()})}),d.on("get_cities",function(e){t.setState({cities:d.getCities()})}),d.on("get_companies",function(e){t.setState({companies:d.getCompanies()})}),d.on("get_company_loc",function(e){t.setState({location:d.getLocation()})})}},{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(v,{title:"Countries",type:"country",items:this.state.countries}),a.a.createElement(v,{title:"Cities",type:"city",items:this.state.cities}),a.a.createElement(v,{title:"Companies",type:"company",items:this.state.companies}),a.a.createElement(O,{location:this.state.location}))}}]),e}(i.Component));c.a.render(a.a.createElement(b,null),document.getElementById("root"))}},[[12,2,1]]]);
//# sourceMappingURL=main.dda4900d.chunk.js.map